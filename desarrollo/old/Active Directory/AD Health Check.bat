@Echo Off
ECHO Running AD Health Checks - Notepad will open after completion
set logfile=%userprofile%\Desktop\Active_Directory_Health.txt
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                                    Active Directory Health Checks >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
REM Finds system boot time
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                                   Domain Controllers In the Domain >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\DSQUERY Server -o rdn >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                                     Repadmin - Syncall - e >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /syncall /e  >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                                     Repadmin - Syncall - a >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /syncall /A>> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                                  	Repadmin - Syncall - d >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /syncall /d >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                                     Repadmin - Replsummary >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /replsummary * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - KCC >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /kcc * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - showbackup >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /showbackup * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Showrepl >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /showrepl *  >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Queue >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /queue * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Bridgeheads >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /bridgeheads * /verbose  >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - ISTG  >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /istg * /verbose >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Showoutcalls >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /showoutcalls * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Failcache >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /failcache * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Showtrust >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /showtrust * >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               			Repadmin - Bind >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\repadmin.exe /bind *  >> %logfile%
echo. >> %logfile%
echo. >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
echo                                               				Dcdiag >> %logfile%
echo ------------------------------------------------------------------------------------------------------------------------ >> %logfile%
C:\Windows\System32\dcdiag /c /e /v>> %logfile%
echo. >> %logfile%
echo. >> %logfile%
notepad %logfile%



















